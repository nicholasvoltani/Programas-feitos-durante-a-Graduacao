import numpy as np
import matplotlib.pyplot as plt

def logistic(x,p):
    return p*x*(1-x)

def derivative(x,p):
    return p*(1-2*x)

ps = np.linspace(1, 4, 167)
x0 = (ps-1)/ps
Ttrans = 1000
Test = 500
lyapunovs = []
pps = []
xs = []

for p in ps:
    x = x0
    lyapunov = np.log(abs(derivative(x,p)))
    for _ in range(Ttrans):
        x = logistic(x,p)
        lyapunov += np.log(abs(derivative(x,p)))
    for _ in range(Test):
        x = logistic(x,p)
        xs.append(x)
        pps.append(p)
        lyapunov += np.log(abs(derivative(x,p)))
    lyapunov /= (Ttrans+Test)
    lyapunovs.append(lyapunov)

plt.subplot(2,1,1)
plt.plot(pps,xs, ',k')
plt.subplot(2,1,2)
print(f"PS {len(ps)}, lpv {len(lyapunovs)}")
plt.scatter(ps,lyapunovs)
plt.show()
        
